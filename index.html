<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Formulario - Gaico Company</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>

<body class="bg-gray-100 font-['Montserrat']">

  <div class="min-h-screen flex flex-col md:flex-row items-center justify-center bg-cover bg-center bg-no-repeat"
    style="background-image: url('https://images.unsplash.com/photo-1552519507-da3b142c6e3d'); background-position: center center;">

    <div
      class="md:flex hidden flex-col justify-center items-start p-8 md:w-1/2 text-white bg-gradient-to-r from-black/70 to-black/40 backdrop-blur-sm rounded-xl m-4 animate-fadeInLeft">
      <h1 id="titulo-principal" class="text-4xl md:text-5xl font-bold mb-4 leading-tight">Asegura tu carro con Gaico Company</h1>
      <p id="subtitulo" class="text-lg opacity-90">La manera más rápida y segura de registrar tu seguro y licencia.</p>
      <div class="mt-8 flex items-center space-x-4">
        <div class="flex items-center justify-center w-12 h-12 rounded-full bg-blue-500/30 backdrop-blur-sm">
          <i class="fas fa-shield-alt text-white text-xl"></i>
        </div>
        <p id="proteccion-text" class="text-sm opacity-80">Protección garantizada las 24 horas</p>
      </div>
    </div>

    <!-- Formulario -->
    <div
      class="bg-white/90 backdrop-blur-md p-8 rounded-xl shadow-2xl w-full max-w-md m-4 animate-fadeInUp border border-white/20">
      
      <!-- Botones superiores -->
      <div class="flex justify-between mb-4">
        <!-- Botón de WhatsApp -->
        <a id="whatsapp-btn" href="https://wa.me/18722132161" target="_blank" 
          class="bg-gradient-to-r from-green-500 to-green-600 text-white px-4 py-2 rounded-lg shadow-lg hover:shadow-xl transition-all flex items-center space-x-2">
          <i class="fab fa-whatsapp"></i>
          <span id="whatsapp-text">Contactar por WhatsApp</span>
        </a>
        
        <!-- Botón de traducción -->
        <button id="btn-translate"
          class="bg-gradient-to-r from-blue-500 to-blue-600 text-white px-4 py-2 rounded-lg shadow-lg hover:shadow-xl transition-all flex items-center space-x-2 ml-2">
          <i class="fas fa-language"></i>
          <span id="btn-translate-text">English</span>
        </button>
      </div>

      <div class="text-center mb-8">
        <div class="w-16 h-16 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-4 shadow-inner">
          <i class="fas fa-car text-blue-600 text-2xl"></i>
        </div>
        <h2 id="bienvenido" class="text-3xl font-bold text-gray-800">Bienvenido</h2>
        <p id="completa-datos" class="text-gray-500 mt-2">Completa tus datos para continuar</p>
      </div>
      
      <form id="formulario" enctype="multipart/form-data" class="space-y-5">

        <div class="space-y-1">
          <label id="label-nombres" class="block font-medium text-gray-700">Nombres</label>
          <div class="relative">
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
              <i class="fas fa-user text-gray-400"></i>
            </div>
            <input type="text" name="nombres" id="nombres-input" placeholder="Ingrese los Nombres"
              class="w-full border border-gray-200 rounded-lg p-3 pl-10 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition bg-white/70 shadow-sm" required>
          </div>
        </div>

        <div class="space-y-1">
          <label id="label-apellidos" class="block font-medium text-gray-700">Apellidos</label>
          <div class="relative">
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
              <i class="fas fa-users text-gray-400"></i>
            </div>
            <input type="text" name="apellidos" id="apellidos-input" placeholder="Ingrese los Apellidos"
              class="w-full border border-gray-200 rounded-lg p-3 pl-10 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition bg-white/70 shadow-sm" required>
          </div>
        </div>

        <div class="space-y-1">
          <label id="label-email" class="block font-medium text-gray-700">Correo Electrónico</label>
          <div class="relative">
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
              <i class="fas fa-envelope text-gray-400"></i>
            </div>
            <input type="email" name="correo" id="email-input" placeholder="Ingrese su correo electrónico"
              class="w-full border border-gray-200 rounded-lg p-3 pl-10 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition bg-white/70 shadow-sm" required>
          </div>
        </div>

        <!-- Campo de licencia mejorado -->
        <div class="space-y-1">
          <label id="label-licencia" class="block font-medium text-gray-700">Foto de licencia</label>
          <div class="relative">
            <input type="file" name="fotoLicencia" id="fotoLicencia" accept="image/*,.pdf" class="hidden" required>
            <label for="fotoLicencia" class="flex flex-col items-center justify-center w-full h-32 border-2 border-dashed border-gray-300 rounded-xl cursor-pointer hover:border-blue-500 hover:bg-blue-50/50 transition-all">
              <div class="flex flex-col items-center justify-center pt-5 pb-6">
                <i class="fas fa-cloud-upload-alt text-3xl text-gray-400 mb-2"></i>
                <p id="licencia-text" class="mb-2 text-sm text-gray-500"><span id="licencia-click-text" class="font-semibold">Haz clic para subir</span> <span id="licencia-drag-text">o arrastra aquí</span></p>
                <p id="licencia-format" class="text-xs text-gray-400">PNG, JPG o PDF (MAX. 5MB)</p>
              </div>
            </label>
            <div id="licencia-preview" class="mt-2 hidden"></div>
          </div>
        </div>

        <!-- Campo de seguro mejorado -->
        <div class="space-y-1">
          <label id="label-seguro" class="block font-medium text-gray-700">Foto del seguro</label>
          <div class="relative">
            <input type="file" name="fotoSeguro" id="fotoSeguro" accept="image/*,.pdf" class="hidden" required>
            <label for="fotoSeguro" class="flex flex-col items-center justify-center w-full h-32 border-2 border-dashed border-gray-300 rounded-xl cursor-pointer hover:border-blue-500 hover:bg-blue-50/50 transition-all">
              <div class="flex flex-col items-center justify-center pt-5 pb-6">
                <i class="fas fa-file-contract text-3xl text-gray-400 mb-2"></i>
                <p id="seguro-text" class="mb-2 text-sm text-gray-500"><span id="seguro-click-text" class="font-semibold">Haz clic para subir</span> <span id="seguro-drag-text">o arrastra aquí</span></p>
                <p id="seguro-format" class="text-xs text-gray-400">PNG, JPG o PDF (MAX. 5MB)</p>
              </div>
            </label>
            <div id="seguro-preview" class="mt-2 hidden"></div>
          </div>
        </div>

        <div class="pt-4">
          <button id="btn-registrarse" type="submit"
            class="w-full bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-3 rounded-xl shadow-lg hover:shadow-xl hover:from-blue-700 hover:to-blue-800 active:scale-[0.98] transition-all duration-200 cursor-pointer flex items-center justify-center space-x-2">
            <span>Registrarse</span>
            <i class="fas fa-arrow-right"></i>
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Animaciones -->
  <style>
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes fadeInLeft {
      from { opacity: 0; transform: translateX(-30px); }
      to { opacity: 1; transform: translateX(0); }
    }
    .animate-fadeInUp { animation: fadeInUp 0.8s ease-out forwards; }
    .animate-fadeInLeft { animation: fadeInLeft 0.8s ease-out forwards; }
    
    /* Estilo para el hover de los campos de archivo */
    [for="fotoLicencia"]:hover i, [for="fotoSeguro"]:hover i {
      transform: translateY(-3px);
      transition: transform 0.3s ease;
    }
  </style>

  <!-- Script de traducción y preview de imágenes -->
  <script>
    const translations = {
      es: {
        "titulo-principal": "Asegura tu carro con Gaico Company",
        "subtitulo": "La manera más rápida y segura de registrar tu seguro y licencia.",
        "proteccion-text": "Protección garantizada las 24 horas",
        "bienvenido": "Bienvenido",
        "completa-datos": "Completa tus datos para continuar",
        "label-nombres": "Nombres",
        "nombres-input": "Ingrese los Nombres",
        "label-apellidos": "Apellidos",
        "apellidos-input": "Ingrese los Apellidos",
        "label-email": "Correo Electrónico",
        "email-input": "Ingrese su correo electrónico",
        "label-licencia": "Foto de licencia",
        "licencia-click-text": "Haz clic para subir",
        "licencia-drag-text": "o arrastra aquí",
        "licencia-format": "PNG, JPG o PDF (MAX. 5MB)",
        "label-seguro": "Foto del seguro",
        "seguro-click-text": "Haz clic para subir",
        "seguro-drag-text": "o arrastra aquí",
        "seguro-format": "PNG, JPG o PDF (MAX. 5MB)",
        "btn-registrarse": "Registrarse",
        "btn-translate-text": "English",
        "whatsapp-text": "Contactar por WhatsApp"
      },
      en: {
        "titulo-principal": "Insure your car with Gaico Company",
        "subtitulo": "The fastest and safest way to register your insurance and license.",
        "proteccion-text": "24/7 guaranteed protection",
        "bienvenido": "Welcome",
        "completa-datos": "Complete your information to continue",
        "label-nombres": "First Name",
        "nombres-input": "Enter your first name",
        "label-apellidos": "Last Name",
        "apellidos-input": "Enter your last name",
        "label-email": "Email Address",
        "email-input": "Enter your email address",
        "label-licencia": "License photo",
        "licencia-click-text": "Click to upload",
        "licencia-drag-text": "or drag here",
        "licencia-format": "PNG, JPG or PDF (MAX. 5MB)",
        "label-seguro": "Insurance photo",
        "seguro-click-text": "Click to upload",
        "seguro-drag-text": "or drag here",
        "seguro-format": "PNG, JPG or PDF (MAX. 5MB)",
        "btn-registrarse": "Register",
        "btn-translate-text": "Español",
        "whatsapp-text": "Contact via WhatsApp"
      }
    };

    let currentLang = "es";

    document.getElementById("btn-translate").addEventListener("click", () => {
      currentLang = currentLang === "es" ? "en" : "es";
      const elements = translations[currentLang];
      
      for (let id in elements) {
        const element = document.getElementById(id);
        if (element) {
          if (id === "btn-registrarse") {
            element.innerHTML = `<span>${elements[id]}</span> <i class="fas fa-arrow-right"></i>`;
          } else if (id.endsWith("-input")) {
            element.placeholder = elements[id];
          } else {
            element.textContent = elements[id];
          }
        }
      }
    });

    // Preview de imágenes
    document.getElementById('fotoLicencia').addEventListener('change', function(e) {
      const preview = document.getElementById('licencia-preview');
      preview.innerHTML = '';
      preview.classList.remove('hidden');
      
      if (this.files && this.files[0]) {
        const file = this.files[0];
        const fileType = file.type.split('/')[0];
        
        if (fileType === 'image') {
          const reader = new FileReader();
          reader.onload = function(e) {
            preview.innerHTML = `
              <div class="flex items-center p-3 bg-blue-50 rounded-lg border border-blue-100">
                <img src="${e.target.result}" class="h-12 w-12 object-cover rounded-md mr-3">
                <div>
                  <p class="text-sm font-medium text-gray-700">${file.name}</p>
                  <p class="text-xs text-gray-500">${(file.size / 1024).toFixed(1)} KB</p>
                </div>
                <button type="button" class="ml-auto text-red-500 hover:text-red-700" onclick="document.getElementById('licencia-preview').classList.add('hidden'); document.getElementById('fotoLicencia').value = '';">
                  <i class="fas fa-times"></i>
                </button>
              </div>
            `;
          }
          reader.readAsDataURL(file);
        } else if (file.type === 'application/pdf') {
          preview.innerHTML = `
            <div class="flex items-center p-3 bg-blue-50 rounded-lg border border-blue-100">
              <div class="h-12 w-12 bg-red-100 rounded-md flex items-center justify-center text-red-500 mr-3">
                <i class="fas fa-file-pdf text-xl"></i>
              </div>
              <div>
                <p class="text-sm font-medium text-gray-700">${file.name}</p>
                <p class="text-xs text-gray-500">${(file.size / 1024).toFixed(1)} KB</p>
              </div>
              <button type="button" class="ml-auto text-red-500 hover:text-red-700" onclick="document.getElementById('licencia-preview').classList.add('hidden'); document.getElementById('fotoLicencia').value = '';">
                <i class="fas fa-times"></i>
              </button>
            </div>
          `;
        }
      }
    });

    document.getElementById('fotoSeguro').addEventListener('change', function(e) {
      const preview = document.getElementById('seguro-preview');
      preview.innerHTML = '';
      preview.classList.remove('hidden');
      
      if (this.files && this.files[0]) {
        const file = this.files[0];
        const fileType = file.type.split('/')[0];
        
        if (fileType === 'image') {
          const reader = new FileReader();
          reader.onload = function(e) {
            preview.innerHTML = `
              <div class="flex items-center p-3 bg-blue-50 rounded-lg border border-blue-100">
                <img src="${e.target.result}" class="h-12 w-12 object-cover rounded-md mr-3">
                <div>
                  <p class="text-sm font-medium text-gray-700">${file.name}</p>
                  <p class="text-xs text-gray-500">${(file.size / 1024).toFixed(1)} KB</p>
                </div>
                <button type="button" class="ml-auto text-red-500 hover:text-red-700" onclick="document.getElementById('seguro-preview').classList.add('hidden'); document.getElementById('fotoSeguro').value = '';">
                  <i class="fas fa-times"></i>
                </button>
              </div>
            `;
          }
          reader.readAsDataURL(file);
        } else if (file.type === 'application/pdf') {
          preview.innerHTML = `
            <div class="flex items-center p-3 bg-blue-50 rounded-lg border border-blue-100">
              <div class="h-12 w-12 bg-red-100 rounded-md flex items-center justify-center text-red-500 mr-3">
                <i class="fas fa-file-pdf text-xl"></i>
              </div>
              <div>
                <p class="text-sm font-medium text-gray-700">${file.name}</p>
                <p class="text-xs text-gray-500">${(file.size / 1024).toFixed(1)} KB</p>
              </div>
              <button type="button" class="ml-auto text-red-500 hover:text-red-700" onclick="document.getElementById('seguro-preview').classList.add('hidden'); document.getElementById('fotoSeguro').value = '';">
                <i class="fas fa-times"></i>
              </button>
            </div>
          `;
        }
      }
    });
  </script>
  
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const form = document.getElementById('formulario');
      const MAX_FILE_SIZE = 5 * 1024 * 1024; 

      const domElements = {
        fotoLicencia: document.getElementById('fotoLicencia'),
        fotoSeguro: document.getElementById('fotoSeguro'),
        licenciaPreview: document.getElementById('licencia-preview'),
        seguroPreview: document.getElementById('seguro-preview')
      };

      const validateFileSize = (file, fileType) => {
        if (file && file.size > MAX_FILE_SIZE) {
          alert(`La ${fileType} excede el tamaño máximo de 5MB`);
          return false;
        }
        return true;
      };

      const clearPreviews = () => {
        domElements.licenciaPreview.classList.add('hidden');
        domElements.seguroPreview.classList.add('hidden');
      };

      const validateForm = () => {
        const requiredFields = [
          { id: 'nombres-input', name: currentLang === 'es' ? 'nombres' : 'first name' },
          { id: 'apellidos-input', name: currentLang === 'es' ? 'apellidos' : 'last name' },
          { id: 'email-input', name: currentLang === 'es' ? 'correo electrónico' : 'email address' },
          { id: 'fotoLicencia', name: currentLang === 'es' ? 'foto de licencia' : 'license photo' },
          { id: 'fotoSeguro', name: currentLang === 'es' ? 'foto del seguro' : 'insurance photo' }
        ];

        for (const field of requiredFields) {
          const element = document.getElementById(field.id);
          if (!element.value && !(element.files && element.files.length > 0)) {
            alert(currentLang === 'es' 
              ? `Por favor complete el campo: ${field.name}`
              : `Please complete the field: ${field.name}`);
            element.focus();
            return false;
          }
        }

        // Validar formato de email
        const email = document.getElementById('email-input').value;
        if (email && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
          alert(currentLang === 'es' 
            ? 'Por favor ingrese un correo electrónico válido'
            : 'Please enter a valid email address');
          return false;
        }

        return true;
      };

      const handleSubmit = async (e) => {
        e.preventDefault();
        
        if (!validateForm()) return;
        
        const fotoLicencia = domElements.fotoLicencia.files[0];
        const fotoSeguro = domElements.fotoSeguro.files[0];
        
        if (!validateFileSize(fotoLicencia, currentLang === 'es' ? 'foto de licencia' : 'license photo')) return;
        if (!validateFileSize(fotoSeguro, currentLang === 'es' ? 'foto del seguro' : 'insurance photo')) return;

        try {
          const formData = new FormData(form);
          const response = await fetch('https://geico-conpany.onrender.com/api/FormData', {
            method: 'POST',
            body: formData
          });

          if (!response.ok) {
            const errorData = await response.json().catch(() => ({}));
            throw new Error(errorData.error || `Error HTTP: ${response.status}`);
          }

          const result = await response.json();
          
          if (!result.success) {
            throw new Error(result.error || (currentLang === 'es' 
              ? 'Error en el procesamiento del formulario' 
              : 'Form processing error'));
          }

          console.log("Respuesta exitosa del servidor:", result);
          
          form.reset();
          clearPreviews();
          alert(currentLang === 'es' 
            ? 'Formulario enviado con éxito' 
            : 'Form submitted successfully');

        } catch (error) {
          console.error("Error en el envío del formulario:", error);
          alert(`Error: ${error.message || (currentLang === 'es' 
            ? 'Ocurrió un error al enviar el formulario' 
            : 'An error occurred while submitting the form')}`);
        }
      };

      form.addEventListener('submit', handleSubmit);
      form.addEventListener('reset', clearPreviews);
    });
  </script>
</body>
</html>